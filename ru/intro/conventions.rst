Соглашения CakePHP
##################

Мы являемся большими поклонниками принципа "соглашения превыше конфигурации".
Несмотря на то, что изучение соглашений (перечень условных правил) CakePHP
занимает какое-то время, их знание сэкономит Вам огромное количество времени
в будущем. Следуя соглашениям, Вы получаете готовую функциональность без
необходимости написания дополнительных настроек. Также соглашения упрощают
процесс совместной разработки, позволяя без особых проблем другим разработчикам
присоединиться к Вашему проекту, не вникая во все тонкости его реализации.

Соглашения Контроллера
======================

Названия классов контроллера обычно пишутся во множественном числе, c
использованием ВерблюжьегоРегистра и оканчиваются на слово ``Controller``. К
примеру такие имена, как ``UsersController`` и ``ArticleCategoriesController``
хорошо соответствуют соглашениям.

Публичные методы контроллеров часто становятся так называемыми 'экшенами',
доступными через веб-браузер. К примеру такая часть URL-адреса ``/users/view``
по умолчанию соответствует методу ``view()`` контроллера ``UsersController``.
Защищенные (protected) или закрытые (private) методы не доступны системе
маршрутизации (роутинга).

URL-адреса и имена котроллеров
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Как Вы только что видели, контроллеры с названием из одного слова связываются с
соответствующим путем URL в нижнем регистре. К примеру ``UsersController``
(объявленный в файле **UsersController.php**) доступен в виде следующего адреса
http://example.com/users.

В то время как Вы можете маршрутизировать контроллеры из нескольких слов как
Вам угодно, в соответствиии с соглашениями, Ваши URL-адреса должны быть в нижнем
регистре разделенные дефисами с использованием класса ``DashedRoute``,
cледовательно ``/article-categories/view-all`` это корректная форрма обращения
к экшену ``ArticleCategoriesController::viewAll()``.

Когда Вы создаете ссылки с использованием  метода ``this->Html->link()``, Вы
можете воспользоваться следующими соглашениями для массива url::

    $this->Html->link('текст-ссылки', [
        'prefix' => 'MyPrefix' // ВерблюжийРегистр
        'plugin' => 'MyPlugin', // ВерблюжийРегистр
        'controller' => 'ControllerName', // ВерблюжийРегистр
        'action' => 'actionName' // верблюжийРегистр
    ]

Для более подробной информации о URL-адресах CakePHP и обработке параметров,
смотрите :ref:`routes-configuration`.

.. _file-and-classname-conventions:

Соглашения об Наименовании классов и Файлов
=====================================

В общих чертах, имена файлов должны совпадать с именами классов, и следовать
стандартам автозагрузки PSR-0 или PSR-4. Вот некоторые примеры имен классов и
их файлов:

-  Класс контроллера ``LatestArticlesController`` может быть найден в файле с
   именем **LatestArticlesController.php**
-  Класс компонента ``MyHandyComponent`` может быть найден в файле с
   именем **MyHandyComponent.php**
-  Класс таблицы ``OptionValuesTable`` может быть найден в файле с
   именем **OptionValuesTable.php**.
-  Класс объекта данных ``OptionValue`` может быть найден в файле с
   именем **OptionValue.php**.
-  Класс поведения ``EspeciallyFunkableBehavior`` может быть найден в файле с
   именем **EspeciallyFunkableBehavior.php**
-  Класс вида ``SuperSimpleView`` может быть найден в файле с
   именем **SuperSimpleView.php**
-  Класс хелпера ``BestEverHelper`` может быть найден в файле с
   именем **BestEverHelper.php**

Каждый файл может быть найден в соответствующей папке/пространстве имен в папке
вашего приложения.

.. _model-and-database-conventions:

Соглашения Модели и Базы данных
===============================

Имена классов таблиц обычно пишутся во множественном числе, c использованием
ВерблюжьегоРегистра. ``Users``, ``ArticleCategories``,
и ``UserFavoritePages`` - примеры хорошего соответствия соглашениям.

Имена таблиц, отвечающие требованиям модели CakePHP - это имена в форме
множественного числа, и если название состоит из нескольких слов, то
они разделяются подчеркиваниями. Такие имена, как ``users``,
``article_categories``, и ``user_favorite_pages`` полностью отвечают требованиям
модели.

В соответствии с соглашениями, при именовании таблиц и их полей должны
использоваться английские слова. В противном случае CakePHP возможно не сможет
правильно обработать словоформы (соотнесение форм единственного и
множественного числа). Если же Вы хотите добавить правила обработки для
некоторых слов Вашего языка, Вы можете воспользоваться служебным
классом :php:class:`Cake\\Utility\\Inflector`.
Помимо определения этих пользовательских служебных правил, этот класс также
позволяет Вам проверять, что CakePHP понимает Ваш пользовательский синтаксис для
форм единственного и множественного числа. Смотрите документацию
:doc:`/core-libraries/inflector` для более подробной информации.

Имена полей, состоящие из двух и более слов, разделяются подчеркиваниями.

Внешние ключи в связях hasMany (один ко многим), belongsTo/hasOne (один к
одному) распознаются по умолчанию как форма единственного числа имени
связанной таблицы с последующим постфиксом ``_id``. Таким образом если таблица
Users имеет связь hasMany с таблицей Articles, то таблица ``articles`` будет
ссылаться на таблицу ``users`` по полю внешнего ключа ``user_id``. Для таких
таблиц, как ``article_categories``, у которых названия состоят из нескольких
слов, внешним ключом будет поле ``article_category_id``.

Объединенные таблицы, полученные при использовании связи BelongsToMany (многие ко
многим) между моделями, должны быть названы таким образом, чтобы имена
составляющих их таблиц перечислялись в алфавитном порядке (``articles_tags``, а
 не ``tags_articles``).

В дополнение к использованию в качестве первичого ключа обычного
автоинкрементного поля, Вы также можете использовать в этих целях поля
UUID. CakePHP создаст уникальный 36-значный UUID
(:php:meth:`Cake\\Utility\\Text::uuid()`), всякий раз когда Вы вызовете метод
``Table::save()``.

Соглашения Вида (Представления)
===============

Файлы шаблонов внешнего вида именуются в соответствии с названиями связанных
с ними методов контроллера, если название метода состоит из нескольких слов, они
разделяются подчеркиваниями. Методу ``viewAll()`` класса
``ArticlesController`` будет соответствовать шаблон
**src/Template/Articles/view_all.ctp**.

Общий принцип именования шаблонов:
**src/Template/Контроллер/имя_метода_.ctp**.

Именуя части Вашего приложения в соответствии с соглашениями CakePHP, Вы
получаете готовую функциональность без проблем, связанных с необходимостью
написания дополнительных параметров. Вот как должно выглядеть Ваше приложение в
итоге:

-  Таблица в базе данных: "articles"
-  Класс таблицы: ``ArticlesTable``, находится в файле **src/Model/Table/ArticlesTable.php**
-  Класс объекта данных: ``Article``, находится в файле **src/Model/Entity/Article.php**
-  Класс контроллера: ``ArticlesController``, находится в файле
   **src/Controller/ArticlesController.php**
-  Шаблон вида, находится в файле **src/Template/Articles/index.ctp**

Зная данные соглашения, Вы будете точно знать, что маршрут
http://example.com/articles/ вызывает метод ``index()`` контроллера
ArticlesController, где автоматически доступна модель Articles (которая уже
связана с таблицей articles в базе данных) и подключает соответствующий вид. Ни
одна из этих связей не требует никаких параметров, а только создания
соответствующей файловой структуры.

После того, как Вы познакомились с базовыми вещами в фреймворке
CakePHP, Вы можете ознакомиться с примером создания простого приложения -
:doc:`/tutorials-and-examples/bookmarks/intro` и увидеть все выше описанное на
практике.

.. meta::
    :title lang=ru: Соглашения CakePHP
    :keywords lang=ru: опыт веб-разработки,maintenance nightmare,метод index,legacy systems,названия методов,класс php,uniform system,config files,tenets,articles,соглашения,conventional controller,лучшие практики,maps,visibility,news articles,functionality,logic,cakephp,developers
